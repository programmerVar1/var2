<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kenneth's Study Hub</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Courier+Prime&display=swap" rel="stylesheet">
    <link href='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.css' rel='stylesheet' />
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js'></script>
    
    <style>
        :root {
            --primary: #3ecf8e;
            --primary-dark: #2fb87a;
            --bg: #000000;
            --surface: #0d1117;
            --text-primary: #f4fffa;
            --text-secondary: #8b9aad;
            --border: #2d3748;
            --glow: 0 0 15px rgba(62, 207, 142, 0.3);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Montserrat', sans-serif;
            background: var(--bg);
            color: var(--text-primary);
            overflow-x: hidden;
        }

        /* Matrix Background */
        #matrix-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1; opacity: 0.15;
        }

        /* Login Page */
        .login-container {
            display: flex; justify-content: center; align-items: center; min-height: 100vh;
        }
        .login-card {
            background: rgba(13, 17, 23, 0.95);
            border: 2px solid var(--primary);
            padding: 48px; width: 100%; max-width: 420px;
            box-shadow: var(--glow);
            font-family: 'Courier Prime', monospace;
        }
        .login-card::before {
            content: '> SYSTEM ACCESS TERMINAL';
            display: block; background: var(--primary); color: #000;
            padding: 5px 10px; margin-bottom: 20px; font-size: 12px; font-weight: bold;
        }

        /* Main App Layout */
        .app-container { display: none; min-height: 100vh; }
        .app-container.active { display: block; }

        nav {
            background: rgba(0, 0, 0, 0.9);
            border-bottom: 2px solid var(--primary);
            padding: 16px 40px;
            display: flex; justify-content: space-between; align-items: center;
        }

        .main-content { max-width: 1400px; margin: 0 auto; padding: 32px; }

        /* Tabs */
        .tabs { display: flex; gap: 10px; margin-bottom: 32px; border-bottom: 1px solid var(--border); }
        .tab {
            padding: 12px 20px; background: none; border: none; color: var(--text-secondary);
            cursor: pointer; font-weight: bold; transition: 0.2s;
        }
        .tab.active { color: var(--primary); border-bottom: 2px solid var(--primary); }

        .tab-content { display: none; }
        .tab-content.active { display: block; }

        /* Grid & Cards */
        .study-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 20px; }
        .sheet-card {
            background: var(--surface); border: 1px solid var(--primary);
            padding: 24px; cursor: pointer; transition: 0.2s;
            font-family: 'Courier Prime', monospace;
        }
        .sheet-card:hover { transform: translateX(5px); box-shadow: var(--glow); }
        .sheet-card h3 { color: var(--primary); margin-bottom: 10px; }

        /* TERMINAL MODAL (No more Alerts) */
        .modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); z-index: 1000; justify-content: center; align-items: center;
        }
        .modal.active { display: flex; }
        .modal-content {
            background: var(--surface); border: 2px solid var(--primary);
            padding: 30px; width: 600px; font-family: 'Courier Prime', monospace;
        }

        /* Forms */
        input, textarea {
            width: 100%; background: #000; border: 1px solid var(--primary);
            padding: 12px; color: var(--primary); margin: 10px 0; font-family: 'Courier Prime';
        }
        .btn {
            padding: 10px 20px; background: var(--primary); border: none; color: #000;
            font-weight: bold; cursor: pointer; text-transform: uppercase;
        }

        /* Flashcard Styling */
        .card-box {
            width: 500px; height: 300px; margin: 0 auto; perspective: 1000px; cursor: pointer;
        }
        .card-inner {
            position: relative; width: 100%; height: 100%; text-align: center;
            transition: transform 0.6s; transform-style: preserve-3d;
        }
        .card-box.flipped .card-inner { transform: rotateY(180deg); }
        .card-face {
            position: absolute; width: 100%; height: 100%; backface-visibility: hidden;
            display: flex; align-items: center; justify-content: center;
            border: 2px solid var(--primary); background: var(--surface); font-size: 1.5rem; padding: 20px;
        }
        .card-back { transform: rotateY(180deg); background: var(--primary); color: #000; }

        /* Quiz Styling */
        .quiz-option {
            padding: 15px; border: 1px solid var(--border); margin: 10px 0;
            cursor: pointer; transition: 0.2s;
        }
        .quiz-option:hover { border-color: var(--primary); background: rgba(62,207,142,0.1); }
    </style>
</head>
<body>

    <canvas id="matrix-bg"></canvas>

    <div id="loginPage" class="login-container">
        <div class="login-card">
            <h2 style="color:var(--primary); margin-bottom:20px;">ðŸ“š Kenneth's Study Hub</h2>
            <form id="authForm">
                <label>> EMAIL</label>
                <input type="email" id="email" required>
                <label>> PASSWORD</label>
                <input type="password" id="password" required>
                <button type="submit" class="btn" style="width:100%; margin-top:10px;">Login</button>
            </form>
        </div>
    </div>

    <div id="appContainer" class="app-container">
        <nav>
            <div style="font-family:'Courier Prime'; color:var(--primary); font-weight:bold;">ðŸ“š KENNETH_STUDY_HUB</div>
            <button class="btn" onclick="location.reload()" style="font-size:12px;">Logout</button>
        </nav>

        <main class="main-content">
            <div class="tabs">
                <button class="tab active" data-tab="sheets-tab">Study Sheets</button>
                <button class="tab" data-tab="cards-tab">Flashcards</button>
                <button class="tab" data-tab="quiz-tab">Quizzes</button>
                <button class="tab" data-tab="calendar-tab">Calendar</button>
            </div>

            <div id="sheets-tab" class="tab-content active">
                <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
                    <h2>Active Sheets</h2>
                    <button class="btn" onclick="toggleModal('sheetModal', true)">+ New Sheet</button>
                </div>
                <div id="sheetGrid" class="study-grid"></div>
            </div>

            <div id="cards-tab" class="tab-content">
                <div class="card-box" id="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="card-inner">
                        <div class="card-face" id="cardFront">Select a sheet first</div>
                        <div class="card-face card-back" id="cardBack">...</div>
                    </div>
                </div>
                <div style="text-align:center; margin-top:20px;">
                    <button class="btn" onclick="changeCard(-1)">Prev</button>
                    <button class="btn" onclick="changeCard(1)">Next</button>
                </div>
            </div>

            <div id="quiz-tab" class="tab-content">
                <div id="quizContainer" style="max-width:600px; margin:0 auto;">
                    <p style="text-align:center; color:var(--text-secondary)">Load a sheet with quiz data to start.</p>
                </div>
            </div>

            <div id="calendar-tab" class="tab-content">
                <div id="calendar" style="background:var(--surface); padding:20px;"></div>
            </div>
        </main>
    </div>

    <div id="sheetModal" class="modal">
        <div class="modal-content">
            <h3 style="color:var(--primary)">> CREATE_NEW_SHEET</h3>
            <input type="text" id="newTitle" placeholder="Title (e.g. Science 101)">
            <textarea id="newContent" rows="8" placeholder="Format:&#10;Term :: Definition&#10;Question? [Opt1, Opt2] *Answer"></textarea>
            <div style="display:flex; gap:10px;">
                <button class="btn" onclick="saveSheet()">Save</button>
                <button class="btn" style="background:var(--border); color:#fff;" onclick="toggleModal('sheetModal', false)">Cancel</button>
            </div>
        </div>
    </div>

    <script>
        let db = [
            { id: 1, title: "Biology Basics", content: "Mitochondria :: Powerhouse of the cell\nNucleus :: Control center\nWhat is the pH of water? [5, 7, 9] *7" }
        ];
        let currentCards = [];
        let currentQuiz = [];
        let cardIdx = 0;

        // Matrix Effect
        const c = document.getElementById('matrix-bg');
        const ctx = c.getContext('2d');
        function matrix() {
            c.width = window.innerWidth; c.height = window.innerHeight;
            const drops = Array(Math.floor(c.width/16)).fill(1);
            setInterval(() => {
                ctx.fillStyle = 'rgba(0,0,0,0.05)'; ctx.fillRect(0,0,c.width,c.height);
                ctx.fillStyle = '#3ecf8e'; ctx.font = '16px monospace';
                drops.forEach((y, i) => {
                    ctx.fillText(String.fromCharCode(0x30A0+Math.random()*33), i*16, y*16);
                    if(y*16 > c.height && Math.random() > 0.98) drops[i] = 0;
                    drops[i]++;
                });
            }, 40);
        }
        matrix();

        // Login Logic
        document.getElementById('authForm').onsubmit = (e) => {
            e.preventDefault();
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('appContainer').classList.add('active');
            renderSheets();
            new FullCalendar.Calendar(document.getElementById('calendar'), { initialView: 'dayGridMonth' }).render();
        };

        // Tab Logic
        document.querySelectorAll('.tab').forEach(t => {
            t.onclick = () => {
                document.querySelectorAll('.tab, .tab-content').forEach(el => el.classList.remove('active'));
                t.classList.add('active');
                document.getElementById(t.dataset.tab).classList.add('active');
                if(t.dataset.tab === 'calendar-tab') window.dispatchEvent(new Event('resize'));
            };
        });

        // Sheets Logic
        function renderSheets() {
            const grid = document.getElementById('sheetGrid');
            grid.innerHTML = db.map(s => `
                <div class="sheet-card" onclick="loadTools(${s.id})">
                    <h3>> ${s.title}</h3>
                    <p style="font-size:12px; color:var(--text-secondary)">Click to activate tools</p>
                </div>
            `).join('');
        }

        function loadTools(id) {
            const s = db.find(x => x.id === id);
            currentCards = []; currentQuiz = [];
            s.content.split('\n').forEach(line => {
                if(line.includes('::')) {
                    const [q, a] = line.split('::');
                    currentCards.push({q: q.trim(), a: a.trim()});
                }
                if(line.includes('?')) {
                    const q = line.split('?')[0] + '?';
                    const opts = line.match(/\[(.*?)\]/)[1].split(',').map(o => o.trim());
                    const ans = line.split('*')[1].trim();
                    currentQuiz.push({q, opts, ans});
                }
            });
            cardIdx = 0;
            updateCard();
            updateQuiz();
            // Switch to flashcards tab automatically
            document.querySelector('[data-tab="cards-tab"]').click();
        }

        function updateCard() {
            if(!currentCards[cardIdx]) return;
            document.getElementById('cardFront').innerText = currentCards[cardIdx].q;
            document.getElementById('cardBack').innerText = currentCards[cardIdx].a;
            document.getElementById('flashcard').classList.remove('flipped');
        }

        window.changeCard = (n) => {
            cardIdx = (cardIdx + n + currentCards.length) % currentCards.length;
            updateCard();
        };

        function updateQuiz() {
            const cont = document.getElementById('quizContainer');
            cont.innerHTML = currentQuiz.map((q, i) => `
                <div style="margin-bottom:30px; border-bottom:1px solid var(--border); padding-bottom:10px;">
                    <p style="color:var(--primary)">${i+1}. ${q.q}</p>
                    ${q.opts.map(o => `<div class="quiz-option" onclick="this.style.background='${o===q.ans?'rgba(62,207,142,0.3)':'rgba(240,73,73,0.3)'}'">${o}</div>`).join('')}
                </div>
            `).join('');
        }

        // Modal Logic
        window.toggleModal = (id, show) => document.getElementById(id).classList.toggle('active', show);
        
        window.saveSheet = () => {
            const t = document.getElementById('newTitle').value;
            const c = document.getElementById('newContent').value;
            if(t && c) {
                db.push({ id: Date.now(), title: t, content: c });
                renderSheets();
                toggleModal('sheetModal', false);
                document.getElementById('newTitle').value = '';
                document.getElementById('newContent').value = '';
            }
        };
    </script>
</body>
</html>
